---
title: "Retorno sobre o investimento em um MBA"
html_document:
  toc: true
  theme: united
---

```{r include = FALSE}
library(dplyr)
```

# Objetivo

O objetivo desta análise é verificar se existe retorno financeiro em realizar um curso de MBA.

Desejamos saber se uma estudante com as características abaixo deve investir na realização do curso, determinando qual será o seu salário após a graduação.

## A estudante possui as caracteristicas abaixo:

A) Mulher
B) Língua mãe não é o inglês
C) GMAT 680-700
D) Aluna de 1o quartil
E) 8 anos de experiência
F) 29 anos

## Dados da amostragem

Os seguintes dados, de 274 estudantes observados, foram coletados.

```{r}
mba <- read.csv("data/mba.csv", stringsAsFactors = FALSE)
names(mba)
```

## As variáveis de interesse presentes na amostragem são:

A) **sex**, o sexo da estudante, no caso feminino. Temos codificada esta informação com os valores 1 (masculino) ou 2 (feminino).
B) **frstlang**, first language, se a língua mãe é inglesa ou não. Temos codificada esta informação com os valores 1 (língua mãe é inglês) ou 2 (língua mãe **não** é inglês).
C) **gmat_tot**, o valor total que o estudante obteve no GMAT.
D) **quarter**, em que quartil o estudante possui desempenho nos cursos já realizados.
E) **work_yrs**, a quantidade em anos que o estudante possui de experiência.
F) **age**, a idade em anos do estudante.


# Análise exploratória do salário

Desejamos saber qual o salário de um ex-estudante após se formar.
Este atributo corresponde à variável **salary** em nossa base.

## Uma análise exploratória sumarisa o salário como:

Média salarial: 
```{r}
mean(mba$salary)
```

Mediana salarial:
```{r}
median(mba$salary)
```

Histograma salário:
```{r}
hist(mba$salary)
```

## Valores de salário inválidos.

A discrepância entre a média e a mediana leva ao questionamento dos valores salariais.

Existem salários com os valores 998 e 999. Estes valores são utilizados na amostragem para denotar profissionais não alocados.
Assim, estas observações, com valores 998 e 999, serão excluídas da análise.

```{r}
mba2 <- mba %>% filter(salary != 998 & salary != 999)
```

## Os dados da amostragem após a filtragem possuem o perfil:

```{r}
mean(mba2$salary)
median(mba2$salary)
hist(mba2$salary)
```

## Valores de salário com zero.

Vemos ainda que que existem salários com valores não realisticos (zero).
Explorando a base de dados podemos constatar observações com valor igual a zero, totalizando 90 de um total de 193.

```{r}
length(mba2$salary)
sum(mba2$salary == 0)
```

Filtramos a amostragem retirando também estas amostras.

```{r}
mba3 <- mba2 %>% filter(salary != 0)
```

## Os dados da amostra resultante possuem o perfil abaixo, mais próximo ao esperado.

```{r}
mean(mba3$salary)
median(mba3$salary)
hist(mba3$salary)
```

# Análises de relevância

Neste ponto, desejamos identificar quais variáveis influenciam ou não o salário.
Assim, iremos realizar uma análise de relevância para as variáveis que conhecemos da estudante alvo.

## Gênero influencia no salário?

Desejamos saber se o gênero influencia no salário final. Iremos neste caso utilizar o teste "One way ANOVA".
Temos portanto:

- Hipótese Nula, H_0: salário não é influenciada pelo gênero.
- Hipótese Alternativa, H_A: salário é influenciada pelo gênero.

```{r}
boxplot(formula = mba3$salary ~ mba3$sex)
oneway.test(mba3, formula = salary ~ sex)
```

Verificamos que existe um salário que é um outlier, correspondente à uma executiva empregada em um grupo pertencente a sua familia, sendo assim estatisticamente distorcivo.

Retiramos portanto a observação do outlier feminino
```{r}
mba4 <- filter(mba3, salary != max(mba3$salary))
```

Sem o outlier feminino, podemos realizar o teste novamente e constatar a relevância do gênero para a análise
```{r}
boxplot(formula = mba4$salary ~mba4$sex)
oneway.test(mba4, formula = salary ~ sex)
```

Com p-value perto de 0, concluímos que o salário é influenciado pelo gênero.

## Língua materna

Desejamos saber se a língua materna influencia no salário final. 
Uma primeira análise das observações mostra um número estatisticamente baixo de estudantes que não possuem a língua inglesa como lingua mãe (apenas 6 do total de 102 observações)
Assim, optamos por não utilizar esta variável na análise.

```{r}
# 1 - inglês | 2 - outros
unique(mba4$frstlang)
sum(mba4$frstlang == 1)
sum(mba4$frstlang == 2)

```

## Quartil
```{r}
boxplot(mba4$salary ~ mba4$quarter)
```

# Modelos de regressão

## Modelo 1 (Salário ~ Quartil)

Teste de hipóste:
- H_0: quartil não influencia o salário
- H_A: quartil influencia o salário

```{r}
modelo1 <- lm(mba4, formula = salary ~ quarter)
summary(modelo1)
```
p-value = 0.00179, quartil influencia no salário 

## Modelo 2 ()
- H_0: anos de experiência não influencia no salário
- H_A: anos de experiência influencia no salário
```{r}
modelo2 <- lm(mba4, formula = salary ~ work_yrs)
summary(modelo2)
```

## Modelo 3
- H_0: idade não influencia no salário
- H_A: idade influencia no salário
```{r}
modelo3 <- lm(mba4, formula = salary ~ age)
summary(modelo3)
```

## Modelo 4
```{r}
modelo4 <- lm(mba4, formula = salary ~ work_yrs + age)
summary(modelo4)
```
usar work_yrs pois age pode ser discriminatório

## Modelo 5
```{r}
modelo5 <- lm(mba4, formula = salary ~ sex + work_yrs + quarter)
summary(modelo5)
```

## Modelo 6
```{r}
modelo5 <- lm(mba4, formula = salary ~ sex + work_yrs + quarter + gmat_tot)
summary(modelo5)
```

# Conclusão

## Influencial no resultado:
- Sexo
- Quartil
- Idade

## Não influenciam
- GMAT

## Covariancia
- Idade e Anos de Experiência, eliminado Idade.

## Não conclusivos,
- Lingua materna

## Valor experado

```{r}
sex <- 2
work_yrs <- 8
quarter <- 1
salary <- 107057.65 - 9977.52 * sex + 932.41 * work_yrs - 3388.7 * quarter

salary
```












